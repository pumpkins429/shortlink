<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pumpkins.shortlink.project.dao.mapper.LinkAccessStatsMapper">


    <insert id="insertRecord" parameterType="com.pumpkins.shortlink.project.dao.entity.LinkAccessStatsDO">
        INSERT INTO
            t_link_access_stats (
            full_short_url,
            date,
            pv,
            uv,
            uip,
            hour,
            weekday,
            create_time,
            update_time,
            del_flag
        )
        VALUES(
                  #{fullShortUrl},
                  #{date},
                  #{pv},
                  #{uv},
                  #{uip},
                  #{hour},
                  #{weekday},
                  #{date},
                  #{date},
                  0
              ) ON DUPLICATE KEY
            UPDATE
                pv = pv + 1,
                uv = uv + 2,
                uip = uip + 3;
    </insert>
</mapper>
